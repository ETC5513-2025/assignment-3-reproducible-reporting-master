---
title: "Global Renewable Energy Leaders in 2023"
author: Master
format:
  html:
    toc: true
    toc-depth: 2
  pdf:
    toc: true
    toc-depth: 2
  docx:
    toc: true
    toc-depth: 2
editor: visual
---

# Methodology

## Top 10 Countries by Renewable Energy Share in 2023

We filtered the dataset to include only the year 2023. The processed data identifies the top 10 countries with the highest share of renewable energy.

**Table 1** lists these countries, and **Figure 1** visualizes the comparison using a horizontal bar chart.

```{r filter-top10, message=FALSE, warning=FALSE, echo=FALSE}
library(readr)
library(tidyverse)
data <- read_csv("renewable-share-energy.filtered/renewable-share-energy.csv")

top10_clean <- data %>%
  filter(Year == 2023, 
         !Entity %in% c("World", "Africa", "Asia", "Europe", "Oceania", 
                        "North America", "South America", "Eastern Africa (EI)")) %>%
  arrange(desc(`Renewables (% equivalent primary energy)`)) %>%
  slice(1:10)

```

```{r table-top10, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)

top10_clean %>%
  select(Entity, Code, Year, `Renewables (% equivalent primary energy)`) %>%
  rename(
    Country = Entity,
    `Renewables (%)` = `Renewables (% equivalent primary energy)`
  ) %>%
  kable(caption = "Table 1. Top 10 Countries by Share of Renewable Energy in 2023")
```

```{r fig-top10, fig.cap="Share of Renewable Energy in Top 10 Countries (2023)", echo=FALSE, message=FALSE, warning=FALSE}

ggplot(top10_clean, aes(x = reorder(Entity, `Renewables (% equivalent primary energy)`), 
                  y = `Renewables (% equivalent primary energy)`)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Top 10 Countries by Renewable Energy Share (2023)",
    x = "Country",
    y = "Renewables (% of Primary Energy)"
  ) +
  theme_minimal()

```

## Which country leads in renewable energy share in 2023?

Norway ranked first in 2023 by renewable energy share. 

To explore why Norway ranked first, we filtered its national records to analyze its renewable energy sources.
**Figure 2** shows the electricity generation by source in Norway from 1965 to 2023. 


```{r table-norway-2023, echo=FALSE, message=FALSE, warning=FALSE}
norway_prod <- read_csv("modern-renewable-prod.filtered/modern-renewable-prod.csv")

norway_2023 <- norway_prod %>%
  filter(Entity == "Norway", Year == 2023) %>%
  select(
    `Electricity from wind - TWh`,
    `Electricity from hydro - TWh`,
    `Electricity from solar - TWh`,
    `Other renewables including bioenergy - TWh`
  ) %>%
  pivot_longer(everything(), names_to = "Source", values_to = "TWh") %>%
  mutate(Source = str_replace(Source, "Electricity from ", ""),
         Source = str_replace(Source, " - TWh", ""))

kable(norway_2023, caption = "Table2: Norway's Renewable Electricity Generation by Source in 2023 (TWh)")
```


**Figure 2 below visualizes the data from Table 2.**

```{r fig-norway-sources, echo=FALSE, fig.cap="Breakdown of Norwayâ€™s Renewable Energy Generation in 2023", fig.height=4.5, fig.width=6}
ggplot(norway_2023, aes(x = reorder(Source, -TWh), y = TWh, fill = Source)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = round(TWh, 1)), vjust = -0.3) +
  labs(x = "Source", y = "Electricity Generated (TWh)") +
  theme_minimal() +
  theme(legend.position = "none")
```
